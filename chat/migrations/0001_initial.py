# Generated by Django 6.0 on 2025-12-30 13:46

import django.core.validators
import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('contenttypes', '0002_remove_content_type_name'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ChatRoom',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('room_type', models.CharField(choices=[('therapy_session', 'Therapy Session'), ('peer_support', 'Peer Support Group'), ('learning_group', 'Learning Group'), ('project_team', 'Project Collaboration'), ('general', 'General Discussion'), ('moderated', 'Moderated Support'), ('therapeutic_coding', 'Therapeutic Coding'), ('social', 'Social Connection')], default='general', max_length=30)),
                ('description', models.TextField(blank=True, null=True)),
                ('safety_level', models.CharField(choices=[('safe_space', 'Safe Space (Heavy Moderation)'), ('supportive', 'Supportive Environment'), ('challenging', 'Growth-Focused'), ('open', 'Open Discussion')], default='supportive', max_length=20)),
                ('is_gated', models.BooleanField(default=False, help_text='Requires emotional readiness assessment')),
                ('requires_consent', models.BooleanField(default=True)),
                ('mood_tracking_enabled', models.BooleanField(default=True)),
                ('trigger_warnings_required', models.BooleanField(default=True)),
                ('max_stress_level', models.IntegerField(default=7, help_text='Maximum stress level allowed to join', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('is_private', models.BooleanField(default=False)),
                ('is_archived', models.BooleanField(default=False)),
                ('max_participants', models.IntegerField(default=20, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)])),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('scheduled_open', models.DateTimeField(blank=True, null=True)),
                ('scheduled_close', models.DateTimeField(blank=True, null=True)),
                ('therapeutic_goal', models.TextField(blank=True, null=True)),
                ('conversation_guidelines', models.JSONField(blank=True, default=list, help_text='List of conversation guidelines for this room')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_chat_rooms', to=settings.AUTH_USER_MODEL)),
                ('moderators', models.ManyToManyField(blank=True, related_name='moderated_chat_rooms', to=settings.AUTH_USER_MODEL)),
                ('therapists', models.ManyToManyField(blank=True, related_name='therapist_chat_rooms', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Therapeutic Chat Room',
                'verbose_name_plural': 'Therapeutic Chat Rooms',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='ChatMessage',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('message_type', models.CharField(choices=[('text', 'Text Message'), ('code', 'Code Snippet'), ('reflection', 'Session Reflection'), ('checkin', 'Wellness Check-in'), ('breakthrough', 'Breakthrough Moment'), ('resource', 'Helpful Resource'), ('exercise', 'Therapeutic Exercise'), ('affirmation', 'Positive Affirmation'), ('trigger_warning', 'Trigger Warning'), ('system', 'System Message'), ('moderation', 'Moderator Action')], default='text', max_length=20)),
                ('content', models.TextField()),
                ('visibility', models.CharField(choices=[('public', 'Visible to all participants'), ('private', 'Direct message to recipient'), ('anonymous', 'Anonymous to group'), ('therapist_only', 'Visible to therapists only'), ('self_reflection', 'Private reflection'), ('moderators_only', 'Moderators only')], default='public', max_length=20)),
                ('is_thread_starter', models.BooleanField(default=False)),
                ('thread_depth', models.IntegerField(default=0)),
                ('emotional_tone', models.CharField(blank=True, help_text="AI-detected emotional tone (e.g., 'hopeful', 'anxious', 'proud')", max_length=50, null=True)),
                ('trigger_warning', models.TextField(blank=True, null=True)),
                ('is_vulnerable_share', models.BooleanField(default=False)),
                ('coping_strategy_shared', models.BooleanField(default=False)),
                ('contains_affirmation', models.BooleanField(default=False)),
                ('therapeutic_label', models.CharField(blank=True, max_length=100, null=True)),
                ('requires_moderation', models.BooleanField(default=False)),
                ('moderation_notes', models.TextField(blank=True, null=True)),
                ('is_flagged', models.BooleanField(default=False)),
                ('flagged_reason', models.CharField(blank=True, max_length=200, null=True)),
                ('attachment', models.FileField(blank=True, null=True, upload_to='chat_attachments/%Y/%m/%d/', validators=[django.core.validators.FileExtensionValidator(['jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'txt', 'mp3', 'wav', 'mp4', 'mov', 'py', 'js', 'html', 'css', 'json'])])),
                ('attachment_caption', models.CharField(blank=True, max_length=200, null=True)),
                ('edited', models.BooleanField(default=False)),
                ('edited_at', models.DateTimeField(blank=True, null=True)),
                ('deleted', models.BooleanField(default=False)),
                ('deleted_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('scheduled_for', models.DateTimeField(blank=True, null=True)),
                ('read_by_count', models.IntegerField(default=0)),
                ('reaction_count', models.IntegerField(default=0)),
                ('share_count', models.IntegerField(default=0)),
                ('helpful_votes', models.IntegerField(default=0)),
                ('supportive_responses', models.IntegerField(default=0)),
                ('deleted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='deleted_chat_messages', to=settings.AUTH_USER_MODEL)),
                ('moderated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='moderated_messages', to=settings.AUTH_USER_MODEL)),
                ('parent_message', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='replies', to='chat.chatmessage')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chat_messages', to=settings.AUTH_USER_MODEL)),
                ('room', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='messages', to='chat.chatroom')),
            ],
            options={
                'verbose_name': 'Therapeutic Chat Message',
                'verbose_name_plural': 'Therapeutic Chat Messages',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='ChatSessionAnalytics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_start', models.DateTimeField()),
                ('session_end', models.DateTimeField(blank=True, null=True)),
                ('starting_stress_level', models.IntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('ending_stress_level', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('messages_sent', models.IntegerField(default=0)),
                ('messages_received', models.IntegerField(default=0)),
                ('reactions_given', models.IntegerField(default=0)),
                ('reactions_received', models.IntegerField(default=0)),
                ('vulnerable_shares', models.IntegerField(default=0)),
                ('coping_strategies_shared', models.IntegerField(default=0)),
                ('affirmations_given', models.IntegerField(default=0)),
                ('affirmations_received', models.IntegerField(default=0)),
                ('trigger_warnings_used', models.IntegerField(default=0)),
                ('safety_plan_activated', models.BooleanField(default=False)),
                ('moderation_interventions', models.IntegerField(default=0)),
                ('breakthrough_moments', models.JSONField(blank=True, default=list)),
                ('insights_gained', models.JSONField(blank=True, default=list)),
                ('follow_up_actions', models.JSONField(blank=True, default=list)),
                ('session_rating', models.IntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('feedback_notes', models.TextField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('room', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='session_analytics', to='chat.chatroom')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chat_analytics', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Chat Session Analytics',
                'verbose_name_plural': 'Chat Session Analytics',
                'ordering': ['-session_start'],
            },
        ),
        migrations.CreateModel(
            name='MessageReaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('reaction_type', models.CharField(choices=[('‚ù§Ô∏è', 'Heart (Support)'), ('ü§ó', 'Virtual Hug'), ('‚òÄÔ∏è', 'Light & Hope'), ('üçÉ', 'Growth'), ('‚≠ê', 'Shining Moment'), ('‚úÖ', 'I Understand'), ('üå¨Ô∏è', 'Take a Breath'), ('‚öì', 'Stay Grounded'), ('üåä', 'Riding the Wave'), ('üå±', 'New Beginning'), ('üí°', 'Great Idea'), ('üëè', 'Well Done'), ('üöÄ', 'Making Progress'), ('üß©', 'Figuring It Out'), ('‚ö†Ô∏è', 'Trigger Warning'), ('üõ°Ô∏è', 'I Feel Safe'), ('üö™', 'Need Space'), ('ü§ù', 'Reaching Out')], max_length=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('emotional_context', models.CharField(blank=True, help_text='Optional: What emotion prompted this reaction', max_length=50, null=True)),
                ('is_supportive', models.BooleanField(default=True)),
                ('is_therapeutic', models.BooleanField(default=False)),
                ('is_anonymous', models.BooleanField(default=False)),
                ('message', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reactions', to='chat.chatmessage')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='message_reactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Message Reaction',
                'verbose_name_plural': 'Message Reactions',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RoomMembership',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('role', models.CharField(choices=[('participant', 'Participant'), ('moderator', 'Moderator'), ('therapist', 'Therapist'), ('facilitator', 'Facilitator'), ('observer', 'Observer'), ('support_bot', 'Support Bot')], default='participant', max_length=20)),
                ('joined_at', models.DateTimeField(auto_now_add=True)),
                ('last_seen', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_muted', models.BooleanField(default=False)),
                ('is_anonymous', models.BooleanField(default=False, help_text='Participate without revealing identity')),
                ('consent_given', models.BooleanField(default=False)),
                ('comfort_level', models.IntegerField(choices=[('1', 'Very Uncomfortable'), ('2', 'Uncomfortable'), ('3', 'Neutral'), ('4', 'Comfortable'), ('5', 'Feeling Safe')], default='3', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('entry_stress_level', models.IntegerField(blank=True, help_text='Stress level when joining', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('exit_stress_level', models.IntegerField(blank=True, help_text='Stress level when leaving', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)])),
                ('therapeutic_goals', models.JSONField(blank=True, default=list, help_text='Personal goals for this chat experience')),
                ('triggers_disclosed', models.JSONField(blank=True, default=list, help_text='List of disclosed triggers for this user')),
                ('notification_preference', models.CharField(choices=[('all', 'All Messages'), ('mentions', 'Only @mentions'), ('none', 'No Notifications'), ('gentle', 'Gentle Reminders Only')], default='gentle', max_length=20)),
                ('has_safety_plan', models.BooleanField(default=False)),
                ('emergency_contact_notified', models.BooleanField(default=False)),
                ('room', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='memberships', to='chat.chatroom')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chat_memberships', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Room Membership',
                'verbose_name_plural': 'Room Memberships',
            },
        ),
        migrations.CreateModel(
            name='TherapeuticChatSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('auto_trigger_warnings', models.BooleanField(default=True, help_text='Automatically add trigger warnings to vulnerable shares')),
                ('vulnerability_timeout', models.IntegerField(default=30, help_text='Minutes to wait before sending vulnerable message', validators=[django.core.validators.MinValueValidator(5), django.core.validators.MaxValueValidator(300)])),
                ('notify_on_mention', models.BooleanField(default=True)),
                ('notify_on_reaction', models.BooleanField(default=True)),
                ('notify_on_breakthrough', models.BooleanField(default=True)),
                ('enable_emotional_tone_detection', models.BooleanField(default=True)),
                ('enable_coping_suggestions', models.BooleanField(default=True)),
                ('enable_affirmation_suggestions', models.BooleanField(default=True)),
                ('show_stress_level_in_chat', models.BooleanField(default=False)),
                ('allow_anonymous_posting', models.BooleanField(default=True)),
                ('archive_chats_after_days', models.IntegerField(default=90, help_text='Automatically archive chats after X days', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(365)])),
                ('gentle_notification_sounds', models.BooleanField(default=True)),
                ('gentle_message_colors', models.BooleanField(default=True)),
                ('hide_stressful_content', models.BooleanField(default=True, help_text='Automatically hide content when stressed')),
                ('link_chats_to_learning', models.BooleanField(default=True, help_text='Automatically connect chat discussions to learning modules')),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='chat_settings', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Therapeutic Chat Setting',
                'verbose_name_plural': 'Therapeutic Chat Settings',
            },
        ),
        migrations.CreateModel(
            name='ChatNotification',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notification_type', models.CharField(choices=[('message', 'New Message'), ('mention', 'You Were Mentioned'), ('reaction', 'Reaction to Your Message'), ('room_invite', 'Room Invitation'), ('safety_check', 'Safety Check-in'), ('breakthrough', 'Breakthrough Alert'), ('gentle_reminder', 'Gentle Reminder'), ('moderation', 'Moderation Action'), ('therapeutic_insight', 'Therapeutic Insight')], max_length=30)),
                ('title', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('is_urgent', models.BooleanField(default=False)),
                ('object_id', models.UUIDField(blank=True, null=True)),
                ('is_gentle', models.BooleanField(default=True, help_text='Use gentle notification style')),
                ('delay_until', models.DateTimeField(blank=True, help_text='Delay notification if user is stressed', null=True)),
                ('is_read', models.BooleanField(default=False)),
                ('read_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('delivered_at', models.DateTimeField(blank=True, null=True)),
                ('content_type', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='contenttypes.contenttype')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='chat_notifications', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Chat Notification',
                'verbose_name_plural': 'Chat Notifications',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['user', 'is_read', 'created_at'], name='chat_chatno_user_id_f660fc_idx'), models.Index(fields=['notification_type', 'created_at'], name='chat_chatno_notific_c7f121_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='chatroom',
            index=models.Index(fields=['room_type', 'safety_level'], name='chat_chatro_room_ty_bd43af_idx'),
        ),
        migrations.AddIndex(
            model_name='chatroom',
            index=models.Index(fields=['is_private', 'is_archived'], name='chat_chatro_is_priv_640397_idx'),
        ),
        migrations.AddIndex(
            model_name='chatmessage',
            index=models.Index(fields=['room', 'created_at'], name='chat_chatme_room_id_466ea2_idx'),
        ),
        migrations.AddIndex(
            model_name='chatmessage',
            index=models.Index(fields=['user', 'created_at'], name='chat_chatme_user_id_bd720b_idx'),
        ),
        migrations.AddIndex(
            model_name='chatmessage',
            index=models.Index(fields=['message_type', 'created_at'], name='chat_chatme_message_beaad1_idx'),
        ),
        migrations.AddIndex(
            model_name='chatmessage',
            index=models.Index(fields=['is_vulnerable_share', 'created_at'], name='chat_chatme_is_vuln_856713_idx'),
        ),
        migrations.AddIndex(
            model_name='chatmessage',
            index=models.Index(fields=['emotional_tone', 'created_at'], name='chat_chatme_emotion_a6ae12_idx'),
        ),
        migrations.AddIndex(
            model_name='chatsessionanalytics',
            index=models.Index(fields=['user', 'session_start'], name='chat_chatse_user_id_11bb6e_idx'),
        ),
        migrations.AddIndex(
            model_name='chatsessionanalytics',
            index=models.Index(fields=['room', 'session_start'], name='chat_chatse_room_id_042a2b_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='messagereaction',
            unique_together={('message', 'user', 'reaction_type')},
        ),
        migrations.AlterUniqueTogether(
            name='roommembership',
            unique_together={('user', 'room')},
        ),
    ]
